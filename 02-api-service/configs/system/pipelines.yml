# Available Pipelines Configuration
# Add new pipelines here - no code changes needed!
#
# Each pipeline must have:
#   id: Unique identifier (used in API calls)
#   name: Human-readable name (displayed in UI)
#   description: What this pipeline does
#   provider: Provider (lowercase: gcp, openai, anthropic)
#   domain: Domain that matches config path (e.g., "cost" for configs/gcp/cost/billing.yml)
#   pipeline: Template name (matches configs/{provider}/{domain}/{pipeline}.yml)
#   required_integration: Integration required to run (GCP_SA, OPENAI, ANTHROPIC)
#   schedule: Default schedule (daily, monthly)
#   enabled: Whether pipeline is available
#   default_timeout_seconds: Default timeout for pipeline execution (optional, defaults to 600)
#
# URL Structure: /api/v1/pipelines/run/{org}/{provider}/{domain}/{pipeline}
# Config path: configs/{provider}/{domain}/{pipeline}.yml (if domain is empty, configs/{provider}/{pipeline}.yml)

pipelines:
  - id: gcp_billing
    name: GCP Billing
    description: Extract daily billing cost data from GCP Cloud Billing export
    provider: gcp
    domain: cost
    pipeline: billing
    required_integration: GCP_SA
    schedule: daily
    enabled: true
    default_timeout_seconds: 900  # 15 minutes for large billing exports

  - id: openai_usage_cost
    name: OpenAI Usage & Cost
    description: Extract usage data and calculate costs from OpenAI API
    provider: openai
    domain: ""
    pipeline: usage_cost
    required_integration: OPENAI
    schedule: daily
    enabled: true
    default_timeout_seconds: 600  # 10 minutes

  - id: anthropic_usage_cost
    name: Anthropic Usage & Cost
    description: Extract usage data and calculate costs from Anthropic API
    provider: anthropic
    domain: ""
    pipeline: usage_cost
    required_integration: ANTHROPIC
    schedule: daily
    enabled: true
    default_timeout_seconds: 600  # 10 minutes

  - id: gcp_billing_accounts
    name: GCP Billing Accounts
    description: Extract billing account information from GCP Cloud Billing API
    provider: gcp
    domain: api
    pipeline: billing_accounts
    required_integration: GCP_SA
    schedule: daily
    enabled: true
    default_timeout_seconds: 600  # 10 minutes

  - id: gcp_compute_instances
    name: GCP Compute Instances
    description: Extract compute instance inventory from GCP Compute Engine API
    provider: gcp
    domain: api
    pipeline: compute_instances
    required_integration: GCP_SA
    schedule: daily
    enabled: true
    default_timeout_seconds: 900  # 15 minutes for large inventories

  - id: saas_subscription_saas_cost
    name: SaaS Subscription Costs
    description: Calculate daily amortized SaaS subscription costs and convert to FOCUS 1.3 format
    provider: saas_subscription
    domain: costs
    pipeline: saas_cost
    required_integration: ""  # No external integration needed - uses internal data
    schedule: daily
    enabled: true
    default_timeout_seconds: 600  # 10 minutes

  # ============================================
  # GenAI PAYG Pipelines (LLM Usage & Cost)
  # ============================================

  - id: genai_payg_openai
    name: OpenAI Usage & Cost
    description: Extract OpenAI token usage and calculate daily costs
    provider: genai
    domain: payg
    pipeline: openai
    required_integration: OPENAI
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_payg_anthropic
    name: Anthropic Usage & Cost
    description: Extract Anthropic token usage and calculate daily costs
    provider: genai
    domain: payg
    pipeline: anthropic
    required_integration: ANTHROPIC
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_payg_gemini
    name: Gemini Usage & Cost
    description: Extract Gemini token usage and calculate daily costs
    provider: genai
    domain: payg
    pipeline: gemini
    required_integration: GEMINI
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_payg_deepseek
    name: DeepSeek Usage & Cost
    description: Extract DeepSeek token usage and calculate daily costs
    provider: genai
    domain: payg
    pipeline: deepseek
    required_integration: DEEPSEEK
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_payg_azure_openai
    name: Azure OpenAI Usage & Cost
    description: Extract Azure OpenAI token usage and calculate daily costs
    provider: genai
    domain: payg
    pipeline: azure_openai
    required_integration: AZURE_OPENAI
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  # ============================================
  # GenAI Commitment Pipelines (Reserved Capacity)
  # ============================================

  - id: genai_commitment_aws_bedrock
    name: AWS Bedrock Provisioned Throughput
    description: Extract AWS Bedrock PT usage and calculate commitment costs
    provider: genai
    domain: commitment
    pipeline: aws_bedrock
    required_integration: AWS_BEDROCK
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_commitment_azure_ptu
    name: Azure OpenAI PTU Commitment
    description: Extract Azure OpenAI PTU usage and calculate commitment costs
    provider: genai
    domain: commitment
    pipeline: azure_ptu
    required_integration: AZURE_OPENAI
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_commitment_gcp_vertex
    name: GCP Vertex AI GSU Commitment
    description: Extract GCP Vertex AI GSU usage and calculate commitment costs
    provider: genai
    domain: commitment
    pipeline: gcp_vertex
    required_integration: GCP_VERTEX
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  # ============================================
  # GenAI Infrastructure Pipelines (GPU/TPU)
  # ============================================

  - id: genai_infrastructure_gcp_gpu
    name: GCP GPU Infrastructure
    description: Extract GCP GPU/TPU usage and calculate infrastructure costs
    provider: genai
    domain: infrastructure
    pipeline: gcp_gpu
    required_integration: GCP_SA
    schedule: daily
    enabled: true
    default_timeout_seconds: 900

  # ============================================
  # GenAI Unified Consolidation Pipeline
  # ============================================

  - id: genai_unified_consolidate
    name: GenAI Unified Consolidation
    description: Consolidate PAYG, Commitment, and Infrastructure costs into unified tables and FOCUS 1.3
    provider: genai
    domain: unified
    pipeline: consolidate
    required_integration: ""  # No external integration - uses internal data
    schedule: daily
    enabled: true
    default_timeout_seconds: 900
