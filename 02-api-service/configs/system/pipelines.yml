# Available Pipelines Configuration
# Add new pipelines here - no code changes needed!
#
# Each pipeline must have:
#   id: Unique identifier (used in API calls)
#   name: Human-readable name (displayed in UI)
#   description: What this pipeline does
#   category: Top-level category (cloud, genai, saas) - matches configs/{category}/...
#   provider: Provider within category (gcp, aws, openai, anthropic)
#   domain: Domain that matches config path (e.g., "cost" for configs/cloud/gcp/cost/billing.yml)
#   pipeline: Template name (matches configs/{category}/{provider}/{domain}/{pipeline}.yml)
#   required_integration: Integration required to run (GCP_SA, OPENAI, ANTHROPIC)
#   schedule: Default schedule (daily, monthly)
#   enabled: Whether pipeline is available
#   default_timeout_seconds: Default timeout for pipeline execution (optional, defaults to 600)
#
# URL Structure: /api/v1/pipelines/run/{org}/{category}/{provider}/{domain}/{pipeline}
# Config path: configs/{category}/{provider}/{domain}/{pipeline}.yml

# ============================================
# Cloud Provider Pipelines (GCP, AWS, Azure, OCI)
# ============================================

pipelines:
  - id: cloud_gcp_cost_billing
    name: GCP Billing
    description: Extract daily billing cost data from GCP Cloud Billing export
    category: cloud
    provider: gcp
    domain: cost
    pipeline: billing
    required_integration: GCP_SA
    schedule: daily
    enabled: true
    default_timeout_seconds: 900  # 15 minutes for large billing exports

  - id: cloud_gcp_api_billing_accounts
    name: GCP Billing Accounts
    description: Extract billing account information from GCP Cloud Billing API
    category: cloud
    provider: gcp
    domain: api
    pipeline: billing_accounts
    required_integration: GCP_SA
    schedule: daily
    enabled: true
    default_timeout_seconds: 600  # 10 minutes

  - id: cloud_gcp_api_compute_instances
    name: GCP Compute Instances
    description: Extract compute instance inventory from GCP Compute Engine API
    category: cloud
    provider: gcp
    domain: api
    pipeline: compute_instances
    required_integration: GCP_SA
    schedule: daily
    enabled: true
    default_timeout_seconds: 900  # 15 minutes for large inventories

  - id: cloud_aws_cost_billing
    name: AWS Cost & Usage Report
    description: Extract AWS CUR billing data
    category: cloud
    provider: aws
    domain: cost
    pipeline: billing
    required_integration: AWS_IAM
    schedule: daily
    enabled: true
    default_timeout_seconds: 900

  - id: cloud_azure_cost_billing
    name: Azure Cost Management
    description: Extract Azure cost management data
    category: cloud
    provider: azure
    domain: cost
    pipeline: billing
    required_integration: AZURE
    schedule: daily
    enabled: true
    default_timeout_seconds: 900

  - id: cloud_oci_cost_billing
    name: OCI Cost Analysis
    description: Extract Oracle Cloud cost analysis data
    category: cloud
    provider: oci
    domain: cost
    pipeline: billing
    required_integration: OCI
    schedule: daily
    enabled: true
    default_timeout_seconds: 900

  # ============================================
  # Cloud FOCUS 1.3 Conversion Pipelines (per provider)
  # ============================================

  - id: cloud_gcp_cost_focus_convert
    name: GCP FOCUS 1.3 Conversion
    description: Convert GCP billing data to FOCUS 1.3 standard
    category: cloud
    provider: gcp
    domain: cost
    pipeline: focus_convert
    required_integration: ""  # Uses internal data
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: cloud_aws_cost_focus_convert
    name: AWS FOCUS 1.3 Conversion
    description: Convert AWS CUR data to FOCUS 1.3 standard
    category: cloud
    provider: aws
    domain: cost
    pipeline: focus_convert
    required_integration: ""  # Uses internal data
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: cloud_azure_cost_focus_convert
    name: Azure FOCUS 1.3 Conversion
    description: Convert Azure Cost Management data to FOCUS 1.3 standard
    category: cloud
    provider: azure
    domain: cost
    pipeline: focus_convert
    required_integration: ""  # Uses internal data
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: cloud_oci_cost_focus_convert
    name: OCI FOCUS 1.3 Conversion
    description: Convert OCI Cost Analysis data to FOCUS 1.3 standard
    category: cloud
    provider: oci
    domain: cost
    pipeline: focus_convert
    required_integration: ""  # Uses internal data
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  # ============================================
  # Subscription Pipelines
  # ============================================

  - id: subscription_costs
    name: Subscription Costs
    description: Calculate daily amortized subscription costs and convert to FOCUS 1.3 format
    category: subscription
    provider: "subscription"  # Use category as provider for 3-segment path: subscription/costs/subscription_cost
    domain: costs
    pipeline: subscription_cost
    required_integration: ""  # No external integration needed - uses internal data
    schedule: daily
    enabled: true
    default_timeout_seconds: 600  # 10 minutes

  # ============================================
  # GenAI PAYG Pipelines (API Usage & Cost)
  # ============================================

  - id: genai_payg_openai
    name: OpenAI Usage & Cost
    description: Extract OpenAI token usage and calculate daily costs
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path: genai/payg/openai
    domain: payg
    pipeline: openai
    required_integration: OPENAI
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_payg_anthropic
    name: Anthropic Usage & Cost
    description: Extract Anthropic token usage and calculate daily costs
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path
    domain: payg
    pipeline: anthropic
    required_integration: ANTHROPIC
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_payg_gemini
    name: Gemini Usage & Cost
    description: Extract Gemini token usage and calculate daily costs
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path
    domain: payg
    pipeline: gemini
    required_integration: GEMINI
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_payg_deepseek
    name: DeepSeek Usage & Cost
    description: Extract DeepSeek token usage and calculate daily costs
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path
    domain: payg
    pipeline: deepseek
    required_integration: DEEPSEEK
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_payg_azure_openai
    name: Azure OpenAI Usage & Cost
    description: Extract Azure OpenAI token usage and calculate daily costs
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path
    domain: payg
    pipeline: azure_openai
    required_integration: AZURE_OPENAI
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  # ============================================
  # GenAI Commitment Pipelines (Reserved Capacity)
  # ============================================

  - id: genai_commitment_aws_bedrock
    name: AWS Bedrock Provisioned Throughput
    description: Extract AWS Bedrock PT usage and calculate commitment costs
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path
    domain: commitment
    pipeline: aws_bedrock
    required_integration: AWS_BEDROCK
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_commitment_azure_ptu
    name: Azure OpenAI PTU Commitment
    description: Extract Azure OpenAI PTU usage and calculate commitment costs
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path
    domain: commitment
    pipeline: azure_ptu
    required_integration: AZURE_OPENAI
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  - id: genai_commitment_gcp_vertex
    name: GCP Vertex AI GSU Commitment
    description: Extract GCP Vertex AI GSU usage and calculate commitment costs
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path
    domain: commitment
    pipeline: gcp_vertex
    required_integration: GCP_VERTEX
    schedule: daily
    enabled: true
    default_timeout_seconds: 600

  # ============================================
  # GenAI Infrastructure Pipelines (GPU/TPU)
  # ============================================

  - id: genai_infrastructure_gcp_gpu
    name: GCP GPU Infrastructure
    description: Extract GCP GPU/TPU usage and calculate infrastructure costs
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path
    domain: infrastructure
    pipeline: gcp_gpu
    required_integration: GCP_SA
    schedule: daily
    enabled: true
    default_timeout_seconds: 900

  # ============================================
  # GenAI Unified Consolidation Pipeline
  # ============================================

  - id: genai_unified_consolidate
    name: GenAI Unified Consolidation
    description: Consolidate PAYG, Commitment, and Infrastructure costs into unified tables and FOCUS 1.3
    category: genai
    provider: "genai"  # Use category as provider for 3-segment path
    domain: unified
    pipeline: consolidate
    required_integration: ""  # No external integration - uses internal data
    schedule: daily
    enabled: true
    default_timeout_seconds: 900

  # ============================================
  # Cloud Unified FOCUS Conversion Pipeline
  # ============================================

  - id: cloud_unified_focus_convert
    name: Cloud FOCUS 1.3 Conversion (All Providers)
    description: Convenience pipeline - converts ALL cloud providers to FOCUS 1.3 in one run. Use per-provider pipelines for granular control.
    category: cloud
    provider: "cloud"  # Use category as provider for 3-segment path
    domain: unified
    pipeline: focus_convert
    required_integration: ""  # No external integration - uses internal data
    schedule: daily
    enabled: true
    default_timeout_seconds: 1200  # Longer timeout for all providers
