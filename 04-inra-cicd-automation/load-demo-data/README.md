# Demo Data Loader for CloudAct

Load realistic demo data into BigQuery for the `genai_community_12282025` organization.

## Overview

This tool generates and loads:
- **GenAI Usage Data**: OpenAI, Anthropic, Gemini (365 days, ~4,000 records)
- **Cloud Billing Data**: GCP, AWS, Azure, OCI (365 days, ~12,000 records)
- **SaaS Subscriptions**: 15 subscription plans

## Quick Start

```bash
# 1. Generate demo data
cd 04-inra-cicd-automation/load-demo-data
python3 generators/generate-demo-data.py

# 2. Set your GCP project
export GCP_PROJECT_ID="your-project-id"

# 3. Load all data
./scripts/load-all.sh
```

## Folder Structure

```
load-demo-data/
├── data/
│   ├── genai/
│   │   ├── openai_usage_raw.json      # 1,810 records
│   │   ├── anthropic_usage_raw.json   # 1,086 records
│   │   └── gemini_usage_raw.json      # 1,086 records
│   ├── cloud/
│   │   ├── gcp_billing_raw.json       # 3,620 records
│   │   ├── aws_billing_raw.json       # 3,620 records
│   │   ├── azure_billing_raw.json     # 2,896 records
│   │   └── oci_billing_raw.json       # 1,810 records
│   └── subscriptions/
│       └── saas_subscription_plans.csv # 15 plans
├── schemas/                            # BigQuery schemas
├── scripts/
│   ├── config.sh                      # Configuration
│   ├── 00-validate-env.sh             # Validate environment
│   ├── 01-load-genai-data.sh          # Load GenAI data
│   ├── 02-load-cloud-data.sh          # Load cloud billing
│   ├── 03-load-subscriptions.sh       # Load subscriptions
│   └── load-all.sh                    # Master script
└── generators/
    └── generate-demo-data.py          # Data generator
```

## Configuration

Edit `scripts/config.sh` or set environment variables:

```bash
export GCP_PROJECT_ID="your-project-id"
export DATASET="genai_community_12282025_prod"  # or _local
```

## Data Characteristics

### GenAI Usage
- **Date Range**: Jan 1 - Dec 28, 2025
- **Patterns**:
  - Weekday usage: 1.3-1.7x baseline
  - Weekend usage: 0.4-0.7x baseline
  - Monthly growth: 5% increase
  - Q4 seasonal peak: 1.1-1.3x

### Cloud Billing
- **GCP Services**: Compute, Storage, BigQuery, Cloud Run, SQL, etc.
- **AWS Services**: EC2, S3, RDS, Lambda, EKS, etc.
- **Azure Services**: VMs, Storage, SQL, AKS, Functions, etc.
- **OCI Services**: Compute, Object Storage, Autonomous DB, etc.

### SaaS Subscriptions
| Provider | Plan | Seats | Monthly Cost |
|----------|------|-------|--------------|
| ChatGPT | TEAM | 25 | $625 |
| Claude | TEAM | 20 | $500 |
| Slack | BUSINESS+ | 50 | $750 |
| GitHub | TEAM | 30 | $120 |
| Figma | ORG | 15 | $675 |
| Notion | BUSINESS | 40 | $720 |
| And 9 more... | | | |

## Usage

### Validate Environment
```bash
./scripts/00-validate-env.sh
```

### Load Individual Data Types
```bash
./scripts/01-load-genai-data.sh       # GenAI only
./scripts/02-load-cloud-data.sh       # Cloud only
./scripts/03-load-subscriptions.sh    # Subscriptions only
```

### Load All Data
```bash
./scripts/load-all.sh
./scripts/load-all.sh --skip-validation  # Skip env check
./scripts/load-all.sh --genai-only       # Only GenAI
```

### Regenerate Data
```bash
# Default: Full year 2025
python3 generators/generate-demo-data.py

# Custom date range
python3 generators/generate-demo-data.py --start-date 2025-06-01 --end-date 2025-12-31

# Different random seed
python3 generators/generate-demo-data.py --seed 123
```

## After Loading: Run Pipelines

After loading raw data, run pipelines to process into final tables:

```bash
# GenAI cost calculation
curl -X POST "http://localhost:8001/api/v1/pipelines/run/genai_community_12282025/genai/payg/cost" \
  -H "X-API-Key: $ORG_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"start_date":"2025-01-01","end_date":"2025-12-28"}'

# SaaS subscription costs
curl -X POST "http://localhost:8001/api/v1/pipelines/run/genai_community_12282025/saas_subscription/costs/saas_cost" \
  -H "X-API-Key: $ORG_API_KEY"

# Cloud FOCUS conversion (repeat for each provider)
curl -X POST "http://localhost:8001/api/v1/pipelines/run/genai_community_12282025/gcp/cost/focus_convert" \
  -H "X-API-Key: $ORG_API_KEY"
```

## Target Tables

### Raw Tables (loaded by this tool)
| Table | Records |
|-------|---------|
| `genai_payg_usage_raw` | ~4,000 |
| `cloud_gcp_billing_raw_daily` | ~3,600 |
| `cloud_aws_billing_raw_daily` | ~3,600 |
| `cloud_azure_billing_raw_daily` | ~2,900 |
| `cloud_oci_billing_raw_daily` | ~1,800 |
| `saas_subscription_plans` | 15 |

### Output Tables (generated by pipelines)
| Table | Description |
|-------|-------------|
| `genai_payg_costs_daily` | Daily GenAI costs |
| `saas_subscription_plan_costs_daily` | Amortized subscription costs |
| `cost_data_standard_1_3` | FOCUS 1.3 unified costs |

## Troubleshooting

### Authentication Error
```bash
gcloud auth login
gcloud config set project YOUR_PROJECT_ID
```

### Dataset Not Found
Ensure the organization is onboarded first:
```bash
curl -X POST "http://localhost:8000/api/v1/organizations/onboard" \
  -H "X-CA-Root-Key: $CA_ROOT_API_KEY" \
  -d '{"org_slug":"genai_community_12282025",...}'
```

### Schema Mismatch
Schemas in `schemas/` must match the target table schemas. Update if needed.

## License

Internal use only - CloudAct demo data.
