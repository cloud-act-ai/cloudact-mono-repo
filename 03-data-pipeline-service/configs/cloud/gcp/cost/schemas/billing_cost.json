{
  "description": "GCP billing cost schema - comprehensive extraction with standardized x_* fields",
  "version": "3.0.0",
  "updated": "2026-01-23",
  "inherits": "system/schemas/x_standard_fields.json",

  "schemas": {
    "billing_cost": {
      "description": "Complete GCP billing cost data with all available fields",
      "fields": [
        {"name": "billing_account_id", "type": "STRING", "mode": "REQUIRED", "description": "GCP billing account identifier"},
        {"name": "service_id", "type": "STRING", "mode": "NULLABLE", "description": "GCP service identifier (e.g., 6F81-5844-456A)"},
        {"name": "service_description", "type": "STRING", "mode": "NULLABLE", "description": "Human-readable service name (e.g., Cloud Run, BigQuery)"},
        {"name": "sku_id", "type": "STRING", "mode": "NULLABLE", "description": "SKU identifier for the resource type"},
        {"name": "sku_description", "type": "STRING", "mode": "NULLABLE", "description": "Human-readable SKU description"},

        {"name": "usage_start_time", "type": "TIMESTAMP", "mode": "REQUIRED", "description": "When resource usage started"},
        {"name": "usage_end_time", "type": "TIMESTAMP", "mode": "REQUIRED", "description": "When resource usage ended"},
        {"name": "export_time", "type": "TIMESTAMP", "mode": "NULLABLE", "description": "When this record was exported from GCP billing"},

        {"name": "project_id", "type": "STRING", "mode": "NULLABLE", "description": "GCP project identifier - MAPS TO x_hierarchy_entity_id"},
        {"name": "project_name", "type": "STRING", "mode": "NULLABLE", "description": "Human-readable project name - MAPS TO x_hierarchy_entity_name"},
        {"name": "project_number", "type": "STRING", "mode": "NULLABLE", "description": "GCP project number"},
        {"name": "project_ancestry_numbers", "type": "STRING", "mode": "NULLABLE", "description": "Project ancestry path (folder/org hierarchy)"},
        {"name": "project_ancestors_json", "type": "STRING", "mode": "NULLABLE", "description": "JSON array of project ancestors"},
        {"name": "project_labels_json", "type": "STRING", "mode": "NULLABLE", "description": "JSON array of project-level labels"},

        {"name": "location_location", "type": "STRING", "mode": "NULLABLE", "description": "Resource location (e.g., us-central1, global)"},
        {"name": "location_country", "type": "STRING", "mode": "NULLABLE", "description": "Country code (e.g., US, EU)"},
        {"name": "location_region", "type": "STRING", "mode": "NULLABLE", "description": "Geographic region"},
        {"name": "location_zone", "type": "STRING", "mode": "NULLABLE", "description": "Availability zone"},

        {"name": "resource_name", "type": "STRING", "mode": "NULLABLE", "description": "Resource name (only in detailed export)"},
        {"name": "resource_global_name", "type": "STRING", "mode": "NULLABLE", "description": "Fully qualified resource name (only in detailed export)"},

        {"name": "cost", "type": "FLOAT64", "mode": "REQUIRED", "description": "Gross cost before credits"},
        {"name": "cost_type", "type": "STRING", "mode": "NULLABLE", "description": "Type of cost (regular, tax, adjustment, rounding_error)"},
        {"name": "cost_at_list", "type": "FLOAT64", "mode": "NULLABLE", "description": "Cost at list price before any discounts"},
        {"name": "cost_at_effective_price_default", "type": "FLOAT64", "mode": "NULLABLE", "description": "Cost at effective price default"},
        {"name": "cost_at_list_consumption_model", "type": "FLOAT64", "mode": "NULLABLE", "description": "Cost at list price for consumption model"},
        {"name": "currency", "type": "STRING", "mode": "NULLABLE", "description": "Billing currency code (e.g., USD, EUR)"},
        {"name": "currency_conversion_rate", "type": "FLOAT64", "mode": "NULLABLE", "description": "Conversion rate to USD"},

        {"name": "usage_amount", "type": "FLOAT64", "mode": "NULLABLE", "description": "Usage quantity in usage units"},
        {"name": "usage_unit", "type": "STRING", "mode": "NULLABLE", "description": "Unit of measurement for usage"},
        {"name": "usage_amount_in_pricing_units", "type": "FLOAT64", "mode": "NULLABLE", "description": "Usage amount converted to pricing units"},
        {"name": "usage_pricing_unit", "type": "STRING", "mode": "NULLABLE", "description": "Pricing unit (e.g., gibibyte hour)"},

        {"name": "price_effective_price", "type": "FLOAT64", "mode": "NULLABLE", "description": "Effective price per pricing unit"},
        {"name": "price_list_price", "type": "FLOAT64", "mode": "NULLABLE", "description": "List price per pricing unit"},
        {"name": "price_unit", "type": "STRING", "mode": "NULLABLE", "description": "Price unit description"},
        {"name": "price_tier_start_amount", "type": "FLOAT64", "mode": "NULLABLE", "description": "Tier start amount for tiered pricing"},
        {"name": "price_pricing_unit_quantity", "type": "FLOAT64", "mode": "NULLABLE", "description": "Pricing unit quantity"},

        {"name": "credits_total", "type": "FLOAT64", "mode": "NULLABLE", "description": "Sum of all credit amounts (negative value)"},
        {"name": "credits_json", "type": "STRING", "mode": "NULLABLE", "description": "JSON array of credits with name, amount, full_name, id, type"},

        {"name": "invoice_month", "type": "STRING", "mode": "NULLABLE", "description": "Invoice month (YYYYMM format)"},
        {"name": "invoice_publisher_type", "type": "STRING", "mode": "NULLABLE", "description": "Invoice publisher type (GOOGLE, THIRD_PARTY)"},

        {"name": "transaction_type", "type": "STRING", "mode": "NULLABLE", "description": "Transaction type"},
        {"name": "seller_name", "type": "STRING", "mode": "NULLABLE", "description": "Seller name for marketplace purchases"},

        {"name": "adjustment_info_json", "type": "STRING", "mode": "NULLABLE", "description": "JSON object with adjustment id, description, mode, type"},
        {"name": "consumption_model_json", "type": "STRING", "mode": "NULLABLE", "description": "JSON object with consumption model id and description"},

        {"name": "labels_json", "type": "STRING", "mode": "NULLABLE", "description": "JSON array of resource labels (key, value)"},
        {"name": "system_labels_json", "type": "STRING", "mode": "NULLABLE", "description": "JSON array of system labels (key, value)"},
        {"name": "tags_json", "type": "STRING", "mode": "NULLABLE", "description": "JSON array of tags (key, value, inherited, namespace)"},

        {"name": "x_ingestion_id", "type": "STRING", "mode": "REQUIRED", "description": "Unique row identifier (UUID) for traceability"},
        {"name": "x_ingestion_date", "type": "DATE", "mode": "REQUIRED", "description": "Date when data was ingested - PARTITION KEY"},
        {"name": "x_org_slug", "type": "STRING", "mode": "REQUIRED", "description": "Organization identifier for multi-tenancy"},

        {"name": "x_hierarchy_entity_id", "type": "STRING", "mode": "NULLABLE", "description": "Hierarchy entity ID (= project_id for GCP)"},
        {"name": "x_hierarchy_entity_name", "type": "STRING", "mode": "NULLABLE", "description": "Hierarchy entity name (= project_name for GCP)"},
        {"name": "x_hierarchy_level_code", "type": "STRING", "mode": "NULLABLE", "description": "Hierarchy level code (ORG, DEPT, PROJ, TEAM)"},
        {"name": "x_hierarchy_path", "type": "STRING", "mode": "NULLABLE", "description": "Full hierarchy path for cost rollup"},
        {"name": "x_hierarchy_path_names", "type": "STRING", "mode": "NULLABLE", "description": "Human-readable hierarchy path names"},
        {"name": "x_hierarchy_validated_at", "type": "TIMESTAMP", "mode": "NULLABLE", "description": "When hierarchy was validated"},

        {"name": "x_pipeline_id", "type": "STRING", "mode": "REQUIRED", "description": "Pipeline template name"},
        {"name": "x_credential_id", "type": "STRING", "mode": "NULLABLE", "description": "Credential ID from org_integration_credentials (optional for external queries)"},
        {"name": "x_pipeline_run_date", "type": "DATE", "mode": "REQUIRED", "description": "The data date being processed"},
        {"name": "x_run_id", "type": "STRING", "mode": "REQUIRED", "description": "Unique pipeline run UUID"},
        {"name": "x_ingested_at", "type": "TIMESTAMP", "mode": "REQUIRED", "description": "Timestamp when data was written"},

        {"name": "x_data_quality_score", "type": "FLOAT64", "mode": "NULLABLE", "description": "Data quality score (0-100)"},
        {"name": "x_created_at", "type": "TIMESTAMP", "mode": "NULLABLE", "description": "Original record creation timestamp"},

        {"name": "x_cloud_provider", "type": "STRING", "mode": "REQUIRED", "description": "Cloud provider identifier (GCP)"},
        {"name": "x_cloud_account_id", "type": "STRING", "mode": "NULLABLE", "description": "Cloud billing account identifier"}
      ]
    },
    "default": {
      "description": "Default schema - auto-detected from query results",
      "fields": []
    }
  }
}
