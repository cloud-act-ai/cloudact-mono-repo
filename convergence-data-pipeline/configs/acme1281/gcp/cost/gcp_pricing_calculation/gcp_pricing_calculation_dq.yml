# Data Quality Rules for pricing_export_final table
description: "Validate aggregated pricing export data"
sample_size: 10000  # Number of rows to sample for validation

expectations:
  # Table-level checks
  - expectation_type: expect_table_row_count_to_be_between
    kwargs:
      min_value: 1

  # export_date checks
  - expectation_type: expect_column_values_to_not_be_null
    kwargs:
      column: export_date

  # billing_account_id checks
  - expectation_type: expect_column_values_to_not_be_null
    kwargs:
      column: billing_account_id

  # record_count checks
  - expectation_type: expect_column_values_to_not_be_null
    kwargs:
      column: record_count

  - expectation_type: expect_column_values_to_be_between
    kwargs:
      column: record_count
      min_value: 1
      max_value: 1000000

  # Ensure record_count is positive
  - expectation_type: expect_column_min_to_be_between
    kwargs:
      column: record_count
      min_value: 1
